# computerArchitecture(コンピュータアーキテクチャ)  

## 第3回

### 整数の計算

(オーバフローフラグの設計は省略)  

4bit加減算器で、符号なしで12-10を計算しよう。  
bit表示すると、ア: <!-- hole 1100-1010 --> = イ: <!-- hole 0010 -->となる。  
キャリーフラグCAは ウ: <!-- hole 立たない(0) --> し、 オーバフローフラグOVは エ: <!-- hole 0 -->  
この演算は正しい。  
4bit加減算器で、符号なしで12+13を計算しよう。  
bit表示すると、オ: <!-- hole 1100+1101 --> = カ: <!-- hole 1001 -->となる。  
CA= キ: <!-- hole 1 --> 、 OV= ク: <!-- hole 0 -->  
この演算は誤り。  
4bit加減算器で、符号付きで-4+(-3)を計算しよう。  
bit表示すると、オ = カとなる。  
CA= キ 、 OV= ク  
この演算は正しい。  
(他にも宿題があるので、それをすべてまとめる。非公開情報)


(どんな計算の時、どのフラグによって、計算が正しいと判断できるかまとめるべき)  

### 小数点の計算

#### 固有小数点数

例えば 10.75は ア: <!-- hole 1010.1100 --> と表される。  
.1100=.1+.01+.000+.0000= イ: <!-- hole 0.5*1+0.25*1+0.125*0+0.0625*0 -->  
ということである。  

整数の場合でも同じことが言えるのであるが、  
2進数 `1xxx` が 符号なしでnを意味するとき、符号ありでは ウ: <!-- hole -(10000-n) --> を意味する。  
2進数 `0xxx` が 符号なしでnを意味するとき、符号ありでは エ: <!-- hole n --> を意味する。  

(演習問題もやる。非公開情報)  

#### 浮動小数点  

##### 浮動小数点とは

固有小数点で表現すると、すぐ溢れてしまい、特に科学技術計算などで困る。  
例えば光の秒速mは0.3×10^9であるが、これを表すのに何bit必要だろうか。  
概算したいときは、 ア: <!-- hole 2^10=1024≒1000=10^3 --> という関係を使う。  
0.3×10^9は300×10^6であるが、(精度無視)  
これはイ: <!-- hole 512×10^3×10^3 --> より小さく、しかし近い。  
イ≒ウ: <!-- hole 2^9×2^10×2^10=2^29 --> である。  
したがって、エ: <!-- hole 29 --> bit必要であるとわかるのである。  
これではもったいないので、「浮動小数点」という、別の表現方法が開発され、IEEEで標準化されている。  
IEEE Standard 754では 単精度32bitの他、倍精度64bitや半精度16bitを用意している。  
これらのbitを符号ビット、オ: <!-- hole 指数ビット --> 、 カ: <!-- hole 仮数ビット --> に分けて使う。  
符号ビットは当然1だけ。なので、オのビット数さえわかれば、単精度なら32-1-(オのビット数)がカのビット数となり、カのビット数は計算で求められる。  
単精度のオ･･･キ: <!-- hole 8 --> bit  
倍精度のオ･･･ク: <!-- hole 11 --> bit  
半精度のオ･･･ケ: <!-- hole 5 --> bit  
である。  

##### 浮動小数点の作り方  

10進数228 を単精度で表現しよう。  
まず2進数に変換すると、11100100である。  
そして、ア: <!-- hole (仮数の)先頭は絶対1(何bitで表すとかではなくて) --> なんだから、先頭の1を省略してしまう。  
すると、イ: <!-- hole 1100100 --> となる。  

これを仮数部23bitにする。足りない分は、ウ: <!-- hole 右に0を補う -->  
エ: <!-- hole 110_0100_0000_0000_0000_0000 --> となる。  

指数部は8bitであり、これが表現できる整数は-127〜128  

ここで、10進数228は、1.1100100×2^7で表されるから、  
指数部は7=0000_0111となりそうだが、なぜか オ: <!-- hole 127 -->だけ足すというルールがあって、  
カ: <!-- hole 127+7=134 --> =0100_0011を指数部とする。  


##### 浮動小数点から数値の求め方

(32ページもまとめる)  

##### IEEE 754 浮動小数点における特殊表現

そもそも浮動小数点では、「仮数部の先頭は必ず1」をフルに応用してしまったため、 ア: <!-- hole 0を表現することができなくなってしまった --> 。  
これをごまかすために、「例外的な表現」を用意した。  
これを特殊表現という。  
ついでに±∞や「非正規化数」だったり、NaNもここで決めている。  
それを表にまとめたのが [イ](img/ieee754_1.png) である。  
非正規化数とは、 ウ: <!-- hole 「仮数部の先頭は必ず1」を使わないで表した数 --> のことである。  
正規化数や非正規化数は、 [エ](img/ieee754_2.png) で表される。  
Sは符号(ビット)、Mは仮数、Mは指数ビット  
非正規化数の2^-126は、単に オ: <!-- hole E=1 --> とみるのではだめなのだろうか。  

##### IEEE 754 浮動小数点の範囲

単精度:最大値は、ア(bit表記せよ): <!-- hole 0_11111110_11111111111111111111111 --> ＝イ(数値でいえ): <!-- hole 1.11...1×2^127 --> であるから、  
およそ2^127である。  
＝(1+1)(2^10)^12 × 2^7  
≒2×10^36×100
 
 







